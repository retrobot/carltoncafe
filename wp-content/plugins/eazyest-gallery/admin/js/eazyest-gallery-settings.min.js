(function(e){function t(){var t=parseInt(e("#thumbs_columns").val(),10);e("#thumbs_page").attr("step",t);var n=parseInt(e("#thumbs_page").val(),10);if(n>0){lowVal=n-n%t;highVal=lowVal+t;if(n-lowVal>highVal-n)n=highVal;else n=lowVal;e("#thumbs_page").val(n)}}function n(){var t=parseInt(e("#folders_columns").val(),10);e("#folders_page").attr("step",t);var n=parseInt(e("#folders_page").val(),10);if(n>0){lowVal=n-n%t;highVal=lowVal+t;if(n-lowVal>highVal-n)n=highVal;else n=lowVal;e("#folders_page").val(n)}}e(document).ready(function(){function r(){if(e("#folder_image").val()=="random_image")e("#random-subfolder").css("visibility","visible");else e("#random-subfolder").css("visibility","hidden")}function i(t,n){var r=new Array("medium","large","full");var i=e(t).val();if(0<=r.indexOf(i))e(n).css("visibility","visible");else e(n).css("visibility","hidden")}e("#folder-select").click(function(){if(e(this).hasClass("open")){if(!e(this).hasClass("loaded")){e("#file-tree").fileTree({root:fileTreeSettings.root,script:fileTreeSettings.script,loadMessage:fileTreeSettings.loadMessage},function(t){var n={action:"eazyest_gallery_select_dir",_wpnonce:e("#file-tree-nonce").val(),dir:t};e.post(fileTreeSettings.script,n,function(t){if("!"!=t)e("#gallery_folder").val(t)})});e("#file-tree").show();e(this).removeClass("open");e(this).addClass("loaded")}else{e("#file-tree").show();e(this).removeClass("open")}}else{e("#file-tree").hide();e(this).addClass("open")}return false});e("#wpcontent").click(function(){e("#file-tree").hide();e("#folder-select").addClass("open")});e("#gallery_folder").change(function(){var t={action:"eazyest_gallery_folder_change",_wpnonce:e("#gallery-folder-nonce").val(),gallery_folder:e("#gallery_folder").val()};e.post(ajaxurl,t,function(t){if(0==t.result){e("#eazyest-ajax-response").hide();e("#create-folder").hide()}else{if(1==t.result){e("#eazyest-ajax-response").html(fileTreeSettings.errorMessage.replace("%s","<code>"+e("#gallery_folder").val()+"</code>")).show("fast",function(){e("#gallery_folder").val(t.folder)})}else{e("#eazyest-ajax-response").html(fileTreeSettings.notExistsMessage).show("fast",function(){e("#create-folder").show()})}}});return false});e("#create-folder").click(function(){var t={action:"eazyest_gallery_create_folder",_wpnonce:e("#gallery-folder-nonce").val(),gallery_folder:e("#gallery_folder").val()};e.post(ajaxurl,t,function(t){if(0==t.result){e("#eazyest-ajax-response").hide();e("#create-folder").hide()}else{e("#eazyest-ajax-response").html(fileTreeSettings.notCreateMessage.replace("%s","<code>"+e("#gallery_folder").val()+"</code>")).show("fast",function(){e("#gallery_folder").val(t.folder)})}});return false});r();e("#folder_image").change(function(){r()});i("#on_thumb_click","#thumb-popup");i("#on_slide_click","#slide-popup");e("#on_thumb_click").change(function(){i("#on_thumb_click","#thumb-popup")});e("#on_slide_click").change(function(){i("#on_slide_click","#slide-popup")});e("#folders_columns").change(function(){n()});e("#folders_page").change(function(){n()});e("#thumbs_columns").change(function(){t()});e("#thumbs_page").change(function(){t()})})})(jQuery)